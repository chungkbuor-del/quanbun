<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Quản lý đơn hàng - Chung</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-3 bg-dark text-white">
    <h3>ĐƠN HÀNG MỚI ĐANG CHỜ</h3>
    <div id="list-order" class="mt-4"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, collection, onSnapshot, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCOasks_plua7yYBVgXIN3dKNIBS3WhO3Y",
            authDomain: "quanbun-6cf3b.firebaseapp.com",
            projectId: "quanbun-6cf3b",
            storageBucket: "quanbun-6cf3b.firebasestorage.app",
            messagingSenderId: "553498423375",
            appId: "1:553498423375:web:8c1ecdc1b3bd14651e7a3a"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        onSnapshot(collection(db, "orders"), (snapshot) => {
            const container = document.getElementById('list-order');
            container.innerHTML = "";
            snapshot.forEach((orderDoc) => {
                const d = orderDoc.data();
                container.innerHTML += `
                    <div class="card bg-secondary text-white mb-2 p-3">
                        <h5>Bàn số: ${d.ban} - Món: ${d.tenMon}</h5>
                        <button class="btn btn-success" onclick="xongMon('${orderDoc.id}')">Xong & Thanh Toán</button>
                    </div>`;
            });
        });

        window.xongMon = async (id) => {
            if(confirm("Xác nhận đã phục vụ?")) {
                await deleteDoc(doc(db, "orders", id));
            }
        };
    </script>
</body>
</html>