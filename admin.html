<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Qu·∫£n l√Ω Qu√°n Chung</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #2c3e50; color: white; padding: 20px; }
        .table-card { background: #34495e; border-radius: 10px; padding: 15px; margin-bottom: 15px; border-left: 5px solid #e74c3c; }
        .item-detail { font-size: 0.9em; color: #ecf0f1; border-top: 1px solid #5d6d7e; padding-top: 5px; margin-top: 5px; }
    </style>
</head>
<body>
    <h2 class="text-center mb-4">üîî ƒê∆†N H√ÄNG THEO B√ÄN</h2>
    <div id="admin-list">ƒêang ƒë·ª£i kh√°ch g·ªçi m√≥n...</div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getFirestore, collection, onSnapshot, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = { /* D√°n l·∫°i m√£ Config c·ªßa b·∫°n ·ªü h√¨nh 7 v√†o ƒë√¢y */ };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        onSnapshot(collection(db, "orders"), (snapshot) => {
            const container = document.getElementById('admin-list');
            container.innerHTML = "";
            snapshot.forEach((orderDoc) => {
                const data = orderDoc.data();
                const monAnHtml = data.danhSachMon.map(m => `‚Ä¢ ${m.name} (${m.price.toLocaleString()}ƒë)`).join('<br>');
                
                container.innerHTML += `
                    <div class="table-card">
                        <div class="d-flex justify-content-between align-items-center">
                            <h4>B√ÄN: ${data.ban}</h4>
                            <button class="btn btn-success" onclick="thanhToan('${orderDoc.id}', '${data.ban}', ${data.tongTien})">
                                THANH TO√ÅN: ${data.tongTien.toLocaleString()}ƒë
                            </button>
                        </div>
                        <div class="item-detail">
                            <b>Danh s√°ch m√≥n (${data.danhSachMon.length} m√≥n):</b><br>
                            ${monAnHtml}
                        </div>
                    </div>`;
            });
        });

        window.thanhToan = async (id, ban, tien) => {
            if(confirm(`B√†n ${ban} thanh to√°n t·ªïng c·ªông: ${tien.toLocaleString()}ƒë. X√°c nh·∫≠n?`)) {
                // ·ªû ƒë√¢y sau n√†y s·∫Ω th√™m l·ªánh g·ª≠i l√™n Google Sheets
                await deleteDoc(doc(db, "orders", id));
            }
        };
    </script>
</body>
</html>
